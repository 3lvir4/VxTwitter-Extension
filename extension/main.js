(()=>{"use strict";async function t(t){try{await navigator.clipboard.writeText(t)}catch(t){}}let e;chrome.storage.sync.get(["extendedOptionsState"]).then((t=>{e=t.extendedOptionsState})),chrome.storage.onChanged.addListener((function(t){for(let[n,{newValue:i}]of Object.entries(t))"extendedOptionsState"===n&&(e=i)})),setInterval((function(){setTimeout((()=>{(function(){const t=window.location.pathname.split("/");return 4===t.length&&t.includes("status")})()&&(document.querySelector("[data-vx-tweet-quotes]")||function(){const t=document.querySelector('article[data-testid="tweet"]').firstChild.firstChild.lastChild,e=t.lastChild.className,n=document.createElement("div");n.className=e;const i=window.location.href+"/quotes",r=document.createElement("a");r.setAttribute("href",i),r.innerHTML='\n  <svg viewBox="0 0 24 24" aria-hidden="true" class="r-1nao33i r-4qtqp9 r-yyyyoo r-1q142lx r-1xvli5t r-dnmrzs r-bnwqim r-1plcrui r-lrvibr"><g><path d="M8.75 21V3h2v18h-2zM18 21V8.5h2V21h-2zM4 21l.004-10h2L6 21H4zm9.248 0v-7h2v7h-2z"></path></g></svg>\n  <span>Quotes</span>\n  ',r.className=t.querySelector('[data-testid="retweet"]').firstChild.className,r.setAttribute("data-vx-tweet-quotes",""),r.style.display="flex",r.style.gap="1rem",r.style.textDecoration="none",n.appendChild(r);const o=t.childNodes;o[o.length-2].firstChild.appendChild(n)}())}),100),document.querySelectorAll('article[data-testid="tweet"]').forEach((function(n){const i=n.querySelector('path[d="M12 2.59l5.7 5.7-1.41 1.42L13 6.41V16h-2V6.41l-3.3 3.3-1.41-1.42L12 2.59zM21 15l-.02 3.51c0 1.38-1.12 2.49-2.5 2.49H5.5C4.11 21 3 19.88 3 18.5V15h2v3.5c0 .28.22.5.5.5h12.98c.28 0 .5-.22.5-.5L19 15h2z"]').parentNode.parentNode.closest('div[role="button"]');if(!i||void 0!==i.dataset.vxLinked)return;const r=[...n.querySelectorAll('a[href*="status"]')].map((function(t){return function(t){const e=t.match(/^http.*\/\d+/)[0];if(!e)return e;const n=e.split("//");return`${n[0]}//vx${n[1]}`}(t.href)})).filter((function(t){return!!t}))[0];i.setAttribute("data-vx-linked",""),i.addEventListener("click",function(n){return function(){setTimeout((function(){const i=document.querySelector('#layers div:nth-of-type(1)[role="menuitem"]');let r="vx";if(e){const t=i.cloneNode(!0);t.lastChild.firstChild.innerText="Copy Raw Link",t.id="raw-link-option",o=t,(a=i).parentNode.insertBefore(o,a.nextSibling),t.addEventListener("click",(()=>{r="raw",i.click()}),!1)}var o,a;i.setAttribute("data-vx-linked",""),i.addEventListener("click",(()=>function(e){setTimeout((async function(){switch(e){case"vx":t(n);break;case"raw":t(n=function(t){const e=t.match(/^http.*\/\d+/)[0];if(!e)return e;const n=e.split("//");return`${n[0]}//${n[1].replace(/^vx/,"")}`}(n))}}),50)}(r)),!1)}),50)}}(r),!0)}))}),1e3),window.addEventListener("keydown",(function(t){const e=t.ctrlKey||t.metaKey,n="c"===t.key.toLowerCase();if(""===window.getSelection().toString()&&e&&n){const t=getVxTweetLink(window.location.href);writeToClipboard(t)}}))})();